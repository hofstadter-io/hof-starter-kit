name: "type"
version: "0.0.1"

helper-types:
  - name: AUTH_ROLE_REGEX
    type: string
    regex: '^(user|admin)$'

spec:
  type: "object"
  fields:
    # NAME
    - name: "name"
      type: NAME_BLACKLIST

    - name: owned
      optional: true
      type: OWNED_SNIPPET

    # XXX TODO - AUTH
    - name: auth
      type: variant
      variants:
        - type: object
          fields:
            - name: default
              type: boolean
        - type: object
          fields:
            - name: view
              type: variant
              variants:
                - type: list
                  items:
                    type: AUTH_ROLE_REGEX
                - type: object
                  fields:
                    - name: public
                      type: AUTH_ROLE_REGEX
                    - name: private
                      type: AUTH_ROLE_REGEX
            - name: create
              type: list
              items:
                type: AUTH_ROLE_REGEX
            - name: update
              type: list
              items:
                type: AUTH_ROLE_REGEX
            - name: delete
              type: list
              items:
                type: AUTH_ROLE_REGEX



    # XXX TODO - VISIBILITY
    # XXX TODO - LOOKUP
    # XXX TODO - RELATIONS

    # original is below
    - name: fields
      type: list
      items:
        type: object
        fields:
          #
          - name: name
            type: NAME_REGEX

          - name: type
            type: "string"
            regex: '^(string|text|integer|decimal|boolean|date|time|datetime|json|jsonb)'
          - name: default
            optional: true
            type: string
            regex: '^[[:word:] -]+$'
          # - name: unique
          #   optional: true
          #   type: boolean
          # - name: nullable
          #   optional: true
          #   type: boolean
          # - name: notNullable
          #   optional: true
          #   type: boolean

    - name: lookup
      optional: true
      type: list
      items:
        type: object
        fields:
          - name: name
            type: NAME_REGEX
          - name: field
            type: NAME_REGEX

    # FILES
    - name: files
      optional: true
      type: FILES_SNIPPET

    # SEEDS
    - name: "seeds"
      optional: true
      type: SEEDS_SNIPPET

    # TRANSLATIONS
    - name: "translations"
      optional: true
      type: I18N_SNIPPET

    # COMPONENTs
    - name: components
      optional: true
      type: COMPONENT_SNIPPET

    # PAGES
    - name: pages
      optional: true
      type: PAGES_SNIPPET
