name: "common"
version: "0.0.1"

# We probably don't actually want a spec for common
# This is mainly used for partials and helpers


spec:
  type: "object"
  fields: []


helper-types:
  - name: NAME_REGEX
    type: string
    regex: '^[[:alpha:]][[:word:]-]*$'

  - name: NAME_BLACKLIST
    type: NAME_REGEX
    blacklist:
      - "cookies"
      - "debug"
      - "graphqlTypes"
      - "i18n"
      - "mailer"
      - "proxy"
      - "user"
      - "components"
      - "defaultRouter"
      - "favicon"
      - "layout"
      - "pageNotFound"
      - "pages"

  - name: PAGE_ROUTE_REGEX
    type: "string"
    regex: '^(\/[[:alpha:]][[:word:]-]*)+$'

  - name: SEEDFILE_REGEX
    type: "string"
    # XXX TODO be more specific here, use multiple more specific?
    regex: '^([[:word:]-]+\/)+[[:word:]-]+\.json$'

  - name: I18NFILE_REGEX
    type: "string"
    # XXX TODO be more specific here, use multiple more specific?
    regex: '^([[:word:]-]+\/)+[[:word:]-]+\.json$'

  - name: FILEPATH_REGEX
    type: "string"
    regex: '^([[:word:]-]+\/)+[[:word:]-]+\.[[:lower:]]{1,4}$'

  - name: FILES_SNIPPET
    type: list
    items:
      type: object
      fields:
      - name: "name"
        type: NAME_BLACKLIST
      - name: "src"
        type: FILEPATH_REGEX
      - name: "dst"
        type: FILEPATH_REGEX

  - name: TYPEPATH_REGEX
    type: "string"
    regex: '^type\.modules\.[[:word:]-]+\.[[:word:]-]+$'

  - name: COMPONENT_REGEX
    type: "string"
    regex: '^(type|module)\.modules\.([[:word:]-]+\.){1,2}components\.[[:word:]-]+$'

  - name: OWNED_SNIPPET
    # XXX Variants?
    type: object
    fields:
      # XXX Variants?
      - name: type
        type: string
        regex: '^(has-one|has-many)$'
      - name: "name"
        optional: true
        type: "string"
        regex: '^[[:alpha:]][[:word:]-]*$'
      - name: no-mutate
        optional: true
        type: boolean

  - name: DATA_SNIPPET
    type: list
    items:
      type: object
      fields:
      - name: "name"
        type: NAME_BLACKLIST
      - name: "type"
        type: TYPEPATH_REGEX
      - name: query
        optional: true
        type: object
        fields:
          - name: type
            type: string
            regex: '^(view|list)$'
          - name: sync
            optional: true
            type: boolean
      - name: mutations
        optional: true
        type: list
        items:
          type: string
          regex: '^(create|update|delete)$'

  - name: COMPONENT_SNIPPET
    type: list
    items:
      type: object
      fields:

      - name: "name"
        type: NAME_BLACKLIST

      - name: style
        optional: true
        type: list
        items:
          type: FILEPATH_REGEX

      - name: content
        optional: true
        type: list
        items:
          type: FILEPATH_REGEX

      - name: current-user
        optional: true
        type: boolean

      - name: data
        optional: true
        type: DATA_SNIPPET

  - name: PAGE_COMPONENT_SNIPPET
    type: list
    items:
      type: object
      fields:
      - name: "name"
        type: "string"
        regex: '^[[:alpha:]][[:word:]-]*$'
      - name: "component"
        type: COMPONENT_REGEX

      - name: current-user
        optional: true
        type: boolean

      - name: data
        optional: true
        type: DATA_SNIPPET
